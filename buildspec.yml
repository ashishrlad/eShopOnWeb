version: 0.2    
phases:
  install:
    commands:
      - curl -sSL https://dot.net/v1/dotnet-install.sh | bash /dev/stdin --channel STS 
      - curl  https://dotnet.microsoft.com/en-us/download/dotnet/7.0/.MSbuild.sh | bash /dev/stdin --channel STS 
  build:
    commands:
      - sudo apt-get update
      - sudo apt-get install -y gpg
      - sudo apt-get install wget
      - wget -O - https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor -o microsoft.asc.gpg
      - sudo mv microsoft.asc.gpg /etc/apt/trusted.gpg.d/
      - wget https://packages.microsoft.com/config/ubuntu/{os-version}/prod.list
      - sudo mv prod.list /etc/apt/sources.list.d/microsoft-prod.list
      - sudo chown root:root /etc/apt/trusted.gpg.d/microsoft.asc.gpg
      - sudo chown root:root /etc/apt/sources.list.d/microsoft-prod.list
      - sudo apt-get update && \
      - sudo apt-get install -y {dotnet-package} 
      - sudo apt-get install -y dotnet-runtime-7.0
      - dotnet restore eShopOnWeb/eShopOnWeb.sln
      - dotnet build eShopOnWeb/eShopOnWeb.sln
